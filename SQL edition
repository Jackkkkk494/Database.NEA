## Prototype
## Jack Wood


from tkinter import*
import sqlite3

global Window
global Query

def Window():

    window = Tk()
    window.geometry("400x400")
    window.title("SGW Database")

    conn = sqlite3.connect('Appointments.db')

    c = conn.cursor()

    c.execute ("""CREATE TABLE IF NOT EXISTS bookings(
        First_Name text,
        Last_Name text,
        Address text,
        Month text,
        Year text,
        Bill integer
        )""")

    def Submit():
    
        conn = sqlite3.connect('Appointments.db')

        c = conn.cursor()

        c.execute("INSERT INTO bookings VALUES (:First_Name,:Last_Name,:Address,:Month,:Year,:Bill)",
                {
                    'First_Name': First_Name.get(),
                    'Last_Name': Last_Name.get(),
                    'Address': Address.get(),
                    'Month':Months.get(),
                    'Year':Years.get(),
                    'Bill':Bill.get()
                })

        conn.commit()
        conn.close()


        First_Name.delete(0,END)
        Last_Name.delete(0,END)
        Address.delete(0,END)
        Bill.delete(0,END)
         
    ##Creates Query Function
    def Query():

        conn = sqlite3.connect('Appointments.db')
        
        c = conn.cursor()

        c.execute("SELECT * , oid FROM bookings")
        Records = c.fetchall()
        print_records = ''

        for record in Records:
            print_records += str(record) + "\n"

            Query_label = Label(window,text=print_records) 
            Query_label.grid(row=8,column=0,columnspan=2)


        conn.commit()
        conn.close()

    ## Creates options for Dropdown Menu
    M_Options = [
        "Jan",
        "Feb",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December"
    ]

    Y_Options = [
        "2022",
        "2023",
        "2024",
        "2025",
    ]

    Months = StringVar()
    Months.set(M_Options[0])
    
    Years = StringVar()
    Years.set(Y_Options[0])

    ## Create Text Boxes
    First_Name = Entry(window, width = 30)
    First_Name.grid(row=0, column=1,padx=20)
    Last_Name = Entry(window, width = 30)
    Last_Name.grid(row=1, column=1,padx=20)
    Address = Entry(window, width = 30)
    Address.grid(row=2, column=1,padx=20)
    Month = OptionMenu(window,Months,*M_Options)
    Month.grid(row=3,column=1,padx=20)
    Year = OptionMenu(window,Years,*Y_Options)
    Year.grid(row=4,column=1)
    Bill = Entry(window, width = 30)
    Bill.grid(row=5, column=1,padx=20)

    ## Create Text Box label
    First_Name_label = Label(window, text="First Name")
    First_Name_label.grid(row=0, column=0)

    Last_Name_label = Label(window, text="Last Name")
    Last_Name_label.grid(row=1, column=0)

    Address_label = Label(window, text="Address")
    Address_label.grid(row=2, column=0)

    Month_label = Label(window,text="Month")
    Month_label.grid(row=3, column=0)

    Year_label = Label(window,text="Year")
    Year_label.grid(row=4, column=0)

    Bill_label = Label(window, text="Bill")
    Bill_label.grid(row=5, column=0)

    ## Creates Submission button
    Submit_btn = Button(window, text="Add Record To Database",command=Submit)
    Submit_btn.grid(row=6, column=0, columnspan=2,pady=10, padx=10, ipadx=100)

    #QueryButton
    Queary_btn = Button(window,text="Show Records", command=Query)
    Queary_btn.grid(row=7,column=0,columnspan=2,pady=10,padx=10,ipadx=137)

    window.mainloop()

Window()
